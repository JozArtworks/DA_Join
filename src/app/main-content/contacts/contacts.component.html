@if (showToast) {
    <div class="toast"[class.show]="toastVisible">Contact successfully created</div>
}

@if (showDialog) {
    <app-contact-dialog
        (cancel)="toggleDialog()"
        (create)="onContactCreated()"
        [contactName]="editName"
        [contactMail]="editMail"
        [contactPhone]="editPhone">
    </app-contact-dialog>
}

<section class="contacts-section"
    (click)="showBtnMenu = false">
    <div class="contacts-list">
        <button class="new-contact" (click)="newContact()">
            <p>Add new contact</p>
            <img src="./assets/icons/contacts/new_contact.svg" alt="">
        </button>
        <ul>
            @for (letter of groupContactsByFirstLetter(); track letter) {
                <li class="letter-category">
                    <p>{{ letter }}</p>
                    @for (contact of contactsService.contacts; track contact; let index = $index) {
                        @if (letter === contact.name.charAt(0).toUpperCase() &&contact.name != undefined) {
                            <section class="single-contact"
                                (click)="showContactInfo(index)"
                                (click)="signalService.isMobile() ? showInfos() : null"
                                [style.backgroundColor]="activeContactIndex === index && contactClicked ? '#2A3647' : ''"
                                [style.color]="activeContactIndex === index && contactClicked ? 'white' : ''"
                            >
                                <div class="contact-icon-small"
                                [style.backgroundColor]="contact.color"
                                [style.border]="activeContactIndex === index && contactClicked ? '2px solid white' : ''"
                                >
                                    {{contact.name.charAt(0).toUpperCase()}}
                                    {{ lastInitial(index) }}
                                </div>
                                <div>
                                    <p>{{ contact.name }}</p>
                                    <a>{{ contact.mail }}</a>
                                </div>
                            </section>
                        }
                    }
                </li>
            }
        </ul>
    </div>

    <div class="contact-infos"
        [style.opacity]="signalService.isMobile() && !signalService.isInfoShown ? '0': '1'"
        [style.transform]="signalService.isInfoShown && signalService.isMobile() || signalService.isDesktop() ? 'translateX(0)': 'translateX(100%)'"
    >
        <app-contact-info 
            [isClicked]="contactClicked"
            [contactIndex]="activeContactIndex"
            (editContactData)="handleContactData($event)"
            (showDialog)="handleStatusDialog($event)">
        </app-contact-info>
    </div>
    <button class="mobile-button"
        (click)="this.signalService.isInfoShown && activeContactIndex != null ? toggleBtnMenu() : toggleDialog()"
        (click)="$event.stopPropagation()"
    >
        <img src="" alt=""
            [src]="this.signalService.isInfoShown ? './assets/icons/contacts/contact_menu.svg' : './assets/icons/contacts/new_contact.svg'"
        >
    </button>
    <div class="button-menu"
    [style.opacity]="showBtnMenu ? '1': '0'"
    [style.transform]="showBtnMenu ? 'translateX(0)': 'translateX(100%)'"
    (click)="$event.stopPropagation()"
    >
        <button (click)="activeContactIndex !=null ? editContact(activeContactIndex) : null" (mouseenter)="btnEdit = true" (mouseleave)="btnEdit = false">
            <img class="contact-menu-icon" [src]="btnEdit ? './assets/icons/kanban/edit_active.svg' : './assets/icons/kanban/edit.svg'" alt="">
            <p [style.color]="btnEdit ? '#29ABE2' : '#0b0e13'">Edit</p>
        </button>
        <button (click)="activeContactIndex !=null ? deleteContact(activeContactIndex) : null" (mouseenter)="btnDelete = true" (mouseleave)="btnDelete = false">
            <img class="contact-menu-icon" [src]="btnDelete ? './assets/icons/kanban/delete_active.svg' : './assets/icons/kanban/delete.svg'" alt="">
            <p [style.color]="btnDelete ? '#29ABE2' : '#0b0e13'">Delete</p>
        </button>
    </div>
</section>